<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Youtube-dl WebUI</title>
    <link rel="stylesheet" href="static/css/bootstrap.min.css" media="screen">
    <link rel="stylesheet" href="static/css/font-awesome.min.css">
    <link rel="stylesheet" href="static/css/main.css">
</head>
<body>

<div class="container">
    <div id="err" class="alert alert-danger" style="display: none" role="alert"></div>
    <div class="row">
        <div class="col-md-4"></div>
        <div class="col-md-4">
            <h2>登录 :</h2>
        </div>
        <div class="col-md-4"></div>
    </div>
    <form class="form-horizontal" action="#" method="POST">
        <div class="form-group">
            <div class="col-lg-4"></div>
            <div class="col-lg-4">
                <input class="form-control" id="uname" name="uname" placeholder="输入用户名" type="text" required>
            </div>
            <div class="col-lg-4"></div>
        </div>
        <div class="form-group">
            <div class="col-lg-4"></div>
            <div class="col-lg-4">
                <input class="form-control" id="password" name="password" placeholder="输入密码" type="password" required>
            </div>
            <div class="col-lg-4"></div>
        </div>

        <div class="form-group">
            <div class="col-lg-4"></div>
            <div class="col-lg-4">
                <button id="lgn" type="submit" class="btn btn-default ">登 陆</button>
            </div>
            <div class="col-lg-4"></div>
        </div>
    </form>
</div><!-- End container -->
{% include "include/footer" %}
<script type="text/javascript">
    $(document).ready(function () {
        $("form").validate({
            onkeyup: false,
            rules: {
                uname: {
                    required: true,

                },
                password: {
                    required: true
                }
            },
            messages: {
                uname: {
                    required: ""
                },
                password: {
                    required: ""
                }
            },
            focusCleanup: true,
            submitHandler: function () {
                var index = layer.load(1, {
                    shade: [0.1, '#fff'] //0.1透明度的白色背景
                });

                $.post("/login", $("form").serialize(), function (data) {
                    $("#err").hide();
                    layer.close(index);
                    if (data.code != 0) {
                        $("#err").text("登录请求失败：" + data.msg);
                        $("#err").show();
                        return;
                    }
                    location.href = "/";
                }).fail(function () {
                    $("#err").text("登录请求失败");
                    $("#err").show();
                    layer.close(index);
                });
            }
        });

        /*$("#lgn").submit(function (e) {
            if (!$.validate.form()) {
                return;
            }
            var index = layer.load(1, {
                shade: [0.1, '#fff'] //0.1透明度的白色背景
            });

            $.post("/login", {}, function (data) {
                $("#err").hide();
                layer.close(index);
                if (data != 0) {
                    $("#err").text("登录请求失败：" + data.msg);
                    $("#err").show();
                    return;
                }
            }).fail(function () {
                $("#err").text("登录请求失败");
                $("#err").show();
                layer.close(index);
            });
            return false;
        });*/

    });
</script>
</body>
</html>
